Traceback (most recent call last):
  File "/home/tzeng/repos/kv_na/train.py", line 264, in <module>
    losses = estimate_loss()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/home/tzeng/repos/kv_na/train.py", line 224, in estimate_loss
    logits, loss = model(X, Y)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 375, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 736, in compile_wrapper
    return fn(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1495, in __call__
    return self._torchdynamo_orig_callable(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1272, in __call__
    result = self._inner_convert(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 629, in __call__
    return _compile(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 1111, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_utils_internal.py", line 97, in wrapper_function
    return function(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 793, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 832, in _compile_inner
    out_code = transform_code_object(code, transform)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py", line 1424, in transform_code_object
    transformations(instructions, code_options)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 267, in _fn
    return fn(*args, **kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py", line 753, in transform
    tracer.run()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3497, in run
    super().run()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1363, in run
    while self.step():
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 1267, in step
    self.dispatch_table[inst.opcode](self, inst)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3672, in RETURN_VALUE
    self._return(inst)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py", line 3653, in _return
    all_stack_locals_metadata = self.output.compile_subgraph(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1422, in compile_subgraph
    self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1696, in compile_and_call_fx_graph
    compiled_fn = self.call_user_compiler(gm, self.example_inputs())
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1811, in call_user_compiler
    return self._call_user_compiler(gm, example_inputs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/output_graph.py", line 1846, in _call_user_compiler
    compiled_fn = compiler_fn(gm, example_inputs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/repro/after_dynamo.py", line 150, in __call__
    compiled_gm = compiler_fn(gm, example_inputs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/__init__.py", line 2380, in __call__
    return compile_fx(model_, inputs_, config_patches=self.config)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 2418, in compile_fx
    return aot_autograd(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/backends/common.py", line 109, in __call__
    cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1199, in aot_module_simplified
    compiled_fn = AOTAutogradCache.load(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/autograd_cache.py", line 1140, in load
    compiled_fn = dispatch_and_compile()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 1184, in dispatch_and_compile
    compiled_fn, _ = create_aot_dispatcher_function(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 576, in create_aot_dispatcher_function
    return _create_aot_dispatcher_function(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 836, in _create_aot_dispatcher_function
    compiled_fn, fw_metadata = compiler_fn(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 245, in aot_dispatch_base
    compiled_fw = compiler(fw_module, updated_flat_args)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_functorch/aot_autograd.py", line 483, in __call__
    return self.compiler_fn(gm, example_inputs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 2250, in fw_compiler_base
    return inner_compile(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 745, in compile_fx_inner
    return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_dynamo/repro/after_aot.py", line 124, in debug_wrapper
    inner_compiled_fn = compiler_fn(gm, example_inputs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 907, in _compile_fx_inner
    mb_compiled_graph = fx_codegen_and_compile(
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1578, in fx_codegen_and_compile
    return scheme.codegen_and_compile(gm, example_inputs, inputs_to_check, graph_kwargs)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/compile_fx.py", line 1456, in codegen_and_compile
    compiled_module = graph.compile_to_module()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/graph.py", line 2293, in compile_to_module
    return self._compile_to_module()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/graph.py", line 2299, in _compile_to_module
    self.codegen_with_cpp_wrapper() if self.cpp_wrapper else self.codegen()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/graph.py", line 2234, in codegen
    self._update_scheduler()
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/graph.py", line 2228, in _update_scheduler
    self.scheduler = Scheduler(self.operations)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 2025, in __init__
    self._init(nodes)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 2103, in _init
    self.nodes = self.fuse_nodes(self.nodes)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 2623, in fuse_nodes
    nodes = self.fuse_nodes_once(nodes)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 3127, in fuse_nodes_once
    for node1, node2 in self.get_possible_fusions(nodes):
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 3257, in get_possible_fusions
    check_all_pairs(node_grouping)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 3242, in check_all_pairs
    if self.can_fuse(node1, node2):
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/_inductor/scheduler.py", line 3645, in can_fuse
    if node2.get_operation_names() & node1.ancestors:
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/utils/_ordered_set.py", line 161, in __and__
    return cast(OrderedSet[T], super().__and__(other))
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/_collections_abc.py", line 638, in __and__
    return self._from_iterable(value for value in other if value in self)
  File "/home/tzeng/anaconda3/envs/lm-arch-comparison/lib/python3.10/site-packages/torch/utils/_ordered_set.py", line 41, in __iter__
    def __iter__(self) -> Iterator[T]:
KeyboardInterrupt
