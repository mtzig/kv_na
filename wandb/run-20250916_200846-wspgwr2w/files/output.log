tensor(4.2783, device='cuda:0')
tensor(4.2833, device='cuda:0')
tensor(4.2864, device='cuda:0')
tensor(4.2891, device='cuda:0')
tensor(4.2893, device='cuda:0')
tensor(4.2905, device='cuda:0')
tensor(4.2931, device='cuda:0')
tensor(4.2895, device='cuda:0')
tensor(4.2833, device='cuda:0')
tensor(4.2898, device='cuda:0')
tensor(4.2973, device='cuda:0')
tensor(4.2917, device='cuda:0')
tensor(4.2908, device='cuda:0')
tensor(4.2845, device='cuda:0')
tensor(4.2901, device='cuda:0')
tensor(4.2851, device='cuda:0')
tensor(4.2875, device='cuda:0')
tensor(4.2864, device='cuda:0')
tensor(4.2916, device='cuda:0')
tensor(4.2920, device='cuda:0')
tensor(4.2836, device='cuda:0')
tensor(4.2927, device='cuda:0')
tensor(4.2857, device='cuda:0')
tensor(4.2852, device='cuda:0')
tensor(4.2935, device='cuda:0')
tensor(4.2877, device='cuda:0')
tensor(4.2829, device='cuda:0')
tensor(4.2891, device='cuda:0')
tensor(4.2858, device='cuda:0')
tensor(4.2943, device='cuda:0')
tensor(4.2911, device='cuda:0')
tensor(4.2838, device='cuda:0')
tensor(4.2894, device='cuda:0')
tensor(4.2913, device='cuda:0')
tensor(4.2857, device='cuda:0')
tensor(4.2845, device='cuda:0')
tensor(4.2882, device='cuda:0')
tensor(4.2863, device='cuda:0')
tensor(4.2924, device='cuda:0')
tensor(4.2918, device='cuda:0')
tensor(4.2864, device='cuda:0')
tensor(4.2854, device='cuda:0')
tensor(4.2904, device='cuda:0')
tensor(4.2853, device='cuda:0')
tensor(4.2899, device='cuda:0')
tensor(4.2841, device='cuda:0')
tensor(4.2923, device='cuda:0')
tensor(4.2910, device='cuda:0')
tensor(4.2859, device='cuda:0')
tensor(4.2834, device='cuda:0')
tensor(4.2810, device='cuda:0')
tensor(4.2917, device='cuda:0')
tensor(4.2980, device='cuda:0')
tensor(4.2862, device='cuda:0')
tensor(4.2835, device='cuda:0')
tensor(4.2889, device='cuda:0')
tensor(4.2858, device='cuda:0')
tensor(4.2861, device='cuda:0')
tensor(4.2868, device='cuda:0')
tensor(4.2957, device='cuda:0')
tensor(4.2811, device='cuda:0')
tensor(4.2829, device='cuda:0')
tensor(4.2891, device='cuda:0')
tensor(4.2855, device='cuda:0')
tensor(4.2926, device='cuda:0')
tensor(4.2958, device='cuda:0')
tensor(4.2876, device='cuda:0')
tensor(4.2920, device='cuda:0')
tensor(4.2853, device='cuda:0')
tensor(4.2861, device='cuda:0')
tensor(4.2904, device='cuda:0')
tensor(4.2890, device='cuda:0')
tensor(4.2898, device='cuda:0')
tensor(4.2918, device='cuda:0')
tensor(4.2862, device='cuda:0')
tensor(4.2828, device='cuda:0')
tensor(4.2795, device='cuda:0')
tensor(4.2924, device='cuda:0')
tensor(4.2910, device='cuda:0')
tensor(4.2899, device='cuda:0')
tensor(4.2905, device='cuda:0')
tensor(4.2932, device='cuda:0')
tensor(4.2889, device='cuda:0')
tensor(4.2868, device='cuda:0')
tensor(4.2917, device='cuda:0')
tensor(4.2840, device='cuda:0')
tensor(4.2873, device='cuda:0')
tensor(4.2802, device='cuda:0')
tensor(4.2836, device='cuda:0')
tensor(4.2978, device='cuda:0')
tensor(4.3007, device='cuda:0')
tensor(4.2840, device='cuda:0')
tensor(4.2912, device='cuda:0')
tensor(4.2793, device='cuda:0')
tensor(4.2854, device='cuda:0')
tensor(4.2839, device='cuda:0')
tensor(4.2865, device='cuda:0')
tensor(4.2956, device='cuda:0')
tensor(4.2842, device='cuda:0')
tensor(4.2835, device='cuda:0')
tensor(4.2818, device='cuda:0')
tensor(4.2808, device='cuda:0')
tensor(4.2871, device='cuda:0')
tensor(4.2858, device='cuda:0')
tensor(4.2838, device='cuda:0')
tensor(4.2881, device='cuda:0')
tensor(4.2830, device='cuda:0')
tensor(4.2826, device='cuda:0')
tensor(4.2855, device='cuda:0')
tensor(4.2871, device='cuda:0')
tensor(4.2880, device='cuda:0')
tensor(4.2966, device='cuda:0')
tensor(4.2921, device='cuda:0')
tensor(4.2812, device='cuda:0')
tensor(4.2815, device='cuda:0')
tensor(4.2917, device='cuda:0')
tensor(4.2864, device='cuda:0')
tensor(4.2867, device='cuda:0')
tensor(4.3006, device='cuda:0')
tensor(4.2880, device='cuda:0')
tensor(4.2762, device='cuda:0')
tensor(4.2941, device='cuda:0')
tensor(4.2858, device='cuda:0')
tensor(4.2854, device='cuda:0')
tensor(4.2891, device='cuda:0')
tensor(4.2881, device='cuda:0')
tensor(4.2770, device='cuda:0')
tensor(4.2889, device='cuda:0')
tensor(4.2867, device='cuda:0')
tensor(4.2880, device='cuda:0')
tensor(4.2833, device='cuda:0')
tensor(4.2869, device='cuda:0')
tensor(4.2858, device='cuda:0')
tensor(4.2849, device='cuda:0')
tensor(4.2869, device='cuda:0')
tensor(4.2862, device='cuda:0')
tensor(4.2883, device='cuda:0')
tensor(4.2807, device='cuda:0')
tensor(4.2966, device='cuda:0')
tensor(4.2913, device='cuda:0')
tensor(4.2798, device='cuda:0')
tensor(4.2857, device='cuda:0')
tensor(4.2899, device='cuda:0')
tensor(4.2889, device='cuda:0')
tensor(4.2852, device='cuda:0')
tensor(4.2899, device='cuda:0')
tensor(4.2878, device='cuda:0')
tensor(4.2859, device='cuda:0')
tensor(4.2813, device='cuda:0')
tensor(4.2982, device='cuda:0')
tensor(4.2918, device='cuda:0')
tensor(4.2883, device='cuda:0')
tensor(4.2832, device='cuda:0')
tensor(4.2849, device='cuda:0')
tensor(4.2893, device='cuda:0')
tensor(4.2854, device='cuda:0')
tensor(4.2839, device='cuda:0')
tensor(4.2855, device='cuda:0')
tensor(4.2871, device='cuda:0')
tensor(4.2807, device='cuda:0')
tensor(4.2855, device='cuda:0')
tensor(4.2851, device='cuda:0')
tensor(4.2729, device='cuda:0')
tensor(4.2885, device='cuda:0')
tensor(4.2813, device='cuda:0')
tensor(4.2844, device='cuda:0')
tensor(4.2878, device='cuda:0')
tensor(4.2756, device='cuda:0')
tensor(4.2798, device='cuda:0')
tensor(4.2861, device='cuda:0')
tensor(4.2926, device='cuda:0')
tensor(4.2849, device='cuda:0')
tensor(4.2868, device='cuda:0')
tensor(4.2856, device='cuda:0')
tensor(4.2891, device='cuda:0')
tensor(4.2906, device='cuda:0')
tensor(4.2878, device='cuda:0')
tensor(4.2825, device='cuda:0')
tensor(4.2861, device='cuda:0')
tensor(4.2916, device='cuda:0')
tensor(4.2867, device='cuda:0')
tensor(4.2780, device='cuda:0')
tensor(4.2934, device='cuda:0')
tensor(4.2819, device='cuda:0')
tensor(4.2842, device='cuda:0')
tensor(4.2874, device='cuda:0')
tensor(4.2918, device='cuda:0')
tensor(4.2868, device='cuda:0')
tensor(4.2890, device='cuda:0')
tensor(4.2865, device='cuda:0')
tensor(4.2898, device='cuda:0')
tensor(4.2898, device='cuda:0')
tensor(4.2827, device='cuda:0')
tensor(4.2900, device='cuda:0')
tensor(4.2955, device='cuda:0')
tensor(4.2818, device='cuda:0')
tensor(4.2864, device='cuda:0')
tensor(4.2925, device='cuda:0')
tensor(4.2824, device='cuda:0')
tensor(4.2975, device='cuda:0')
tensor(4.2868, device='cuda:0')
tensor(4.2823, device='cuda:0')
tensor(4.2814, device='cuda:0')
tensor(4.2759, device='cuda:0')
tensor(4.2779, device='cuda:0')
tensor(4.2762, device='cuda:0')
tensor(4.2843, device='cuda:0')
tensor(4.2817, device='cuda:0')
tensor(4.2727, device='cuda:0')
tensor(4.2828, device='cuda:0')
tensor(4.2830, device='cuda:0')
tensor(4.2848, device='cuda:0')
tensor(4.2786, device='cuda:0')
tensor(4.2781, device='cuda:0')
tensor(4.2792, device='cuda:0')
tensor(4.2845, device='cuda:0')
tensor(4.2824, device='cuda:0')
tensor(4.2857, device='cuda:0')
tensor(4.2771, device='cuda:0')
tensor(4.2830, device='cuda:0')
tensor(4.2799, device='cuda:0')
tensor(4.2829, device='cuda:0')
tensor(4.2791, device='cuda:0')
tensor(4.2828, device='cuda:0')
tensor(4.2776, device='cuda:0')
tensor(4.2766, device='cuda:0')
tensor(4.2917, device='cuda:0')
tensor(4.2804, device='cuda:0')
tensor(4.2769, device='cuda:0')
tensor(4.2746, device='cuda:0')
tensor(4.2820, device='cuda:0')
tensor(4.2776, device='cuda:0')
tensor(4.2896, device='cuda:0')
tensor(4.2833, device='cuda:0')
tensor(4.2841, device='cuda:0')
tensor(4.2796, device='cuda:0')
tensor(4.2819, device='cuda:0')
tensor(4.2847, device='cuda:0')
tensor(4.2809, device='cuda:0')
tensor(4.2745, device='cuda:0')
tensor(4.2809, device='cuda:0')
tensor(4.2847, device='cuda:0')
tensor(4.2741, device='cuda:0')
tensor(4.2844, device='cuda:0')
tensor(4.2792, device='cuda:0')
tensor(4.2774, device='cuda:0')
tensor(4.2866, device='cuda:0')
tensor(4.2809, device='cuda:0')
tensor(4.2731, device='cuda:0')
tensor(4.2840, device='cuda:0')
tensor(4.2747, device='cuda:0')
tensor(4.2853, device='cuda:0')
tensor(4.2760, device='cuda:0')
tensor(4.2907, device='cuda:0')
tensor(4.2750, device='cuda:0')
tensor(4.2785, device='cuda:0')
tensor(4.2930, device='cuda:0')
tensor(4.2820, device='cuda:0')
tensor(4.2896, device='cuda:0')
tensor(4.2766, device='cuda:0')
tensor(4.2800, device='cuda:0')
tensor(4.2865, device='cuda:0')
tensor(4.2785, device='cuda:0')
tensor(4.2760, device='cuda:0')
tensor(4.2801, device='cuda:0')
tensor(4.2827, device='cuda:0')
tensor(4.2780, device='cuda:0')
tensor(4.2811, device='cuda:0')
tensor(4.2846, device='cuda:0')
tensor(4.2806, device='cuda:0')
tensor(4.2795, device='cuda:0')
tensor(4.2845, device='cuda:0')
tensor(4.2885, device='cuda:0')
tensor(4.2860, device='cuda:0')
tensor(4.2834, device='cuda:0')
tensor(4.2803, device='cuda:0')
tensor(4.2858, device='cuda:0')
tensor(4.2855, device='cuda:0')
tensor(4.2802, device='cuda:0')
tensor(4.2767, device='cuda:0')
tensor(4.2822, device='cuda:0')
tensor(4.2849, device='cuda:0')
tensor(4.2755, device='cuda:0')
tensor(4.2798, device='cuda:0')
tensor(4.2849, device='cuda:0')
tensor(4.2792, device='cuda:0')
tensor(4.2850, device='cuda:0')
tensor(4.2816, device='cuda:0')
tensor(4.2738, device='cuda:0')
tensor(4.2865, device='cuda:0')
tensor(4.2815, device='cuda:0')
tensor(4.2766, device='cuda:0')
tensor(4.2816, device='cuda:0')
tensor(4.2805, device='cuda:0')
tensor(4.2820, device='cuda:0')
tensor(4.2817, device='cuda:0')
tensor(4.2835, device='cuda:0')
tensor(4.2815, device='cuda:0')
tensor(4.2825, device='cuda:0')
tensor(4.2776, device='cuda:0')
tensor(4.2917, device='cuda:0')
tensor(4.2766, device='cuda:0')
tensor(4.2767, device='cuda:0')
tensor(4.2800, device='cuda:0')
tensor(4.2767, device='cuda:0')
tensor(4.2905, device='cuda:0')
tensor(4.2858, device='cuda:0')
tensor(4.2878, device='cuda:0')
tensor(4.2808, device='cuda:0')
tensor(4.2918, device='cuda:0')
tensor(4.2846, device='cuda:0')
tensor(4.2793, device='cuda:0')
tensor(4.2833, device='cuda:0')
tensor(4.2830, device='cuda:0')
tensor(4.2883, device='cuda:0')
tensor(4.2816, device='cuda:0')
tensor(4.2807, device='cuda:0')
tensor(4.2842, device='cuda:0')
tensor(4.2777, device='cuda:0')
tensor(4.2837, device='cuda:0')
tensor(4.2870, device='cuda:0')
tensor(4.2809, device='cuda:0')
tensor(4.2834, device='cuda:0')
tensor(4.2867, device='cuda:0')
tensor(4.2801, device='cuda:0')
tensor(4.2803, device='cuda:0')
tensor(4.2794, device='cuda:0')
tensor(4.2862, device='cuda:0')
tensor(4.2816, device='cuda:0')
tensor(4.2842, device='cuda:0')
tensor(4.2780, device='cuda:0')
tensor(4.2852, device='cuda:0')
tensor(4.2847, device='cuda:0')
tensor(4.2921, device='cuda:0')
tensor(4.2817, device='cuda:0')
tensor(4.2809, device='cuda:0')
tensor(4.2871, device='cuda:0')
tensor(4.2795, device='cuda:0')
tensor(4.2813, device='cuda:0')
tensor(4.2778, device='cuda:0')
tensor(4.2799, device='cuda:0')
tensor(4.2878, device='cuda:0')
tensor(4.2795, device='cuda:0')
Traceback (most recent call last):
  File "/home/tzeng/repos/kv_na/train.py", line 265, in <module>
    losses = estimate_loss()
             ^^^^^^^^^^^^^^^
  File "/home/tzeng/anaconda3/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/tzeng/repos/kv_na/train.py", line 224, in estimate_loss
    logits, loss = model(X, Y)
                   ^^^^^^^^^^^
  File "/home/tzeng/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tzeng/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tzeng/repos/kv_na/model.py", line 218, in forward
    step_logits = self.lm_head(x[:, [-1], :])        # (b, 1, vocab_size)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/tzeng/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _wrapped_call_impl
    def _wrapped_call_impl(self, *args, **kwargs):

KeyboardInterrupt
